q: To solve the lab, log in as the administrator and delete carlos.

1. To solve this issue, is we have to do manual crawling to gather all related API information.
2. Go to my account. 
- Try to login using any username password combination.
- Click forgot password and enter username.
3. Observe all the url in burpsuite and try to find anything related to api and see also the

4. There is no 'api' mentioned in the url, however there is  

fetch(window.location.pathname, config)

in GET /static/js/forgotPassword.js

what does it means? this means it is a post request to current page path. which shows the hidden api endpoint here is

POST /forgot-password.

Also in the response there is another url path which is /forgot-password?reset_token=${resetToken};. we will take note on this and save for later

5. We are going to find possible exploitation method.

6. Send the POST /forgot-password to repeater.
7. Send the request and it shows the 200 OK response.
8. we will try to alter the username from administrator to administrators and observer the response.
- the response is invalid username.
9. next we are going to attempt to add second parameter value pair using a & encoded character and observe the response
- & url-encoded = %26
- value-pair = x=y
- 

from the response it shows parameter not supported. what can we deduce from here is that potential parameter pollution is available as 
it accepted the parameter value pairs. 

10. we will try to truncate it to further proof the potential exploit by adding url-encoded # (%23)
observe the response.

the response shows that we need to input field into the parameter

11. input the field 

12. Field is invalid, what can we do here is to try brute force the field using intruder. Highlight the value of the field, right
    click and send to intruder

13. Add payload server side parameter and attack.

observe the lenght of the response, most of the length with same value is due to same error response, only email and username have 
different response length. this shows that email is the supported field.

14. Put email as the value for the field and response is success with valid email as body.

15. previously we have seen the url for token, we can see that there is also one available field which is token reset token.

16. replace email with replace token and we will get token as response.

17. the token we get we put in the url path we capture earlier.

18. the page request prompt for new password. enter the new password, login with new credential, and remove carlos.
